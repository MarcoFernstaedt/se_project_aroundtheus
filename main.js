!function(){"use strict";class e{constructor(e){let{name:t,link:s,userId:r,_id:i,ownerId:n,isLiked:o,handleImageClick:a,handleDeleteClick:l,handleLikeClick:d,cardSelector:c}=e;this._name=t,this._link=s,this._userId=r,this._cardId=i,this._ownerId=n,this._isLiked=o,this._handleImageClick=a,this._handleDeleteClick=l,this._handleLikeClick=d,this._cardSelector=c,this._cardElement=document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0),this._cardImage=this._cardElement.querySelector(".card__image"),this._likeButton=this._cardElement.querySelector(".card__like-button")}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})})),this._cardElement.querySelector(".card__trashButton").addEventListener("click",(()=>this._handleDeleteClick(this)))}toggleLikeButton(){this._likeButton.classList.toggle("card__like-button_active")}renderLikes(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}isliked(){console.log(this._likes)}deleteCard(){this._cardElement.remove(),this._cardElement=null}getView(){return this._setEventListeners(),this.renderLikes(),this._cardImage.src=this._link,this._cardImage.alt=this._name,this._cardElement.querySelector(".card__title").textContent=this._name,this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._inputElems=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._submitButton=this._formElement.querySelector(this._submitButtonSelector)}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_showInputError(e,t){const s=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=e.validationMessage,s.classList.add(this._errorClass)}_hasInvalidInput(){return!this._inputElems.every((e=>e.validity.valid))}resetValidation(){this.toggleButtonState(),this._inputElems.forEach((e=>{this._hideInputError(e)}))}toggleButtonState(){this._hasInvalidInput()?this._disableButton():this._enableButton()}_setEventListeners(){this._inputElems.forEach(((e,t,s)=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class s{constructor(e){this._popup=document.querySelector(e)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};close(){this._popup.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}open(){this._popup.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__container-preview"))&&this.close(),e.target.classList.contains("modal__close")&&this.close()}))}}class r extends s{constructor(e,t){super(e),this._handleFormSubmit=t,this._form=this._popup.querySelector(".modal__form"),this._inputList=this._form.querySelectorAll(".modal__form-input"),this._submitButton=this._popup.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}_getInputValues(){return this._inputValues={},this._inputList.forEach((e=>{this._inputValues[e.name]=e.value})),this._inputValues}setButtonText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}setEventListeners(){this._form.addEventListener("submit",(()=>{this._data=this._getInputValues(),this._handleFormSubmit(this._data)})),super.setEventListeners()}open(){this._form.reset(),super.open()}close(){this._form.reset(),super.close()}}class i{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._selector=t,this._section=document.querySelector(this._selector)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._section.prepend(e)}}const n=document.querySelector(".profile__avatar-button"),o=(document.querySelector(".profile__image"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector(".profile__edit-button")),a=document.querySelector(".profile__add-button"),l=(document.forms["profile-form"],document.forms["card-form"]),d=document.querySelector("#profile-title-input"),c=document.querySelector("#profile-description-input"),h=(l.querySelector("#card-title-input"),l.querySelector("#card-image-input"),"#edit-avatar-modal"),{apiToken:_,apiUrl:u}={apiToken:"2aecf13b-f884-4550-afc8-5336476728b3",apiUrl:"https://around-api.en.tripleten-services.com/v1"};let m=null;const p=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_handleResponce(e){if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._handleResponce)}editUserInfo(e){let{name:t,job:s}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:s})}).then(this._handleResponce)}editProfilePhoto(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})}).then(this._handleResponce)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._handleResponce)}createCard(e){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._handleResponce)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._handleResponce)}addCardLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._handleResponce)}removeCardLike(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._handleResponce)}}({baseUrl:u,headers:{authorization:_,"Content-Type":"application/json"}}),f=new class{constructor(e,t,s){this._nameElem=document.querySelector(e),this._jobElem=document.querySelector(t),this._avatarElem=document.querySelector(s)}getUserInfo(){return{name:this._nameElem.textContent,job:this._jobElem.textContent,avatar:this._avatarElem.src}}setUserInfo(e){let{name:t,job:s,avatar:r}=e;this._nameElem.textContent=t,this._jobElem.textContent=s,r&&(this._avatarElem.src=r)}}(".profile__title",".profile__description",".profile__image"),E=e=>{b.setSubmitAction((()=>{p.deleteCard(e._id).then((()=>{e.deleteCard(),b.close()})).catch((e=>{console.error(e)}))})),b.open()},v=e=>{e._isLiked?p.removeCardLike(e._cardId).then((()=>{e.toggleLikeButton()})).catch((e=>{console.error(e)})):p.addCardLike(e._cardId).then((()=>{e.toggleLikeButton()})).catch((e=>{console.error(e)}))},b=new class extends s{constructor(e){super(e),this._form=this._popup.querySelector(".modal__form")}open(){this._form.reset(),super.open()}close(){this._form.reset(),super.close()}setSubmitAction(e){this._handleFormSubmit=e}setEventListeners(){this._form.addEventListener("submit",(()=>{this._handleFormSubmit()})),super.setEventListeners()}}("#delete-modal");b.setEventListeners(),Promise.all([p.getUserInfo(),p.getInitialCards()]).then((e=>{let[t,s]=e;f.setUserInfo({name:t.name,job:t.about,avatar:t.avatar}),m=new i({items:s,renderer:e=>{m.addItem(S(e,null))}},".cards__list"),m.renderItems()})).catch((e=>{console.error(e)}));const k={};var L;L={formSelector:".modal__form",inputSelector:".modal__form-input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error-visible"},Array.from(document.querySelectorAll(L.formSelector)).forEach((e=>{const s=new t(L,e),r=e.getAttribute("name");k[r]=s,s.enableValidation()})),o.addEventListener("click",(()=>{const e=f.getUserInfo();d.value=e.name,c.value=e.job,B.open(),k["profile-form"].resetValidation()}));const S=(t,s)=>{let{name:r,link:i,_id:n,ownerId:o,isLiked:a}=t;return new e({name:r,link:i,userId:s,_id:n,ownerId:o,isLiked:a,handleImageClick:C,handleDeleteClick:E,handleLikeClick:v,cardSelector:"#card-template"}).getView()},C=e=>{let{name:t,link:s}=e;y.open({name:t,link:s})},g=new r(h,(e=>{g.setButtonText(!0),p.editProfilePhoto(e).then((e=>{console.log(e),f.setUserInfo(e),g.close()})).catch((e=>{console.error(e)})).finally((()=>g.setButtonText()))}));g.setEventListeners();const y=new class extends s{constructor(e){super(e),this._title=this._popup.querySelector(".modal__caption"),this._image=this._popup.querySelector(".modal__image")}open(e){let{link:t,name:s}=e;this._title.textContent=s,this._image.src=t,this._image.alt=s,super.open()}}("#preview-card-modal");y.setEventListeners();const I=new r("#add-card-modal",(e=>{I.setButtonText(!0),p.createCard(e).then((e=>{m.addItem(S(e,null)),I.close()})).catch((e=>{console.error(e)})).finally((()=>I.setButtonText(!1)))}));I.setEventListeners();const B=new r("#edit-profile-modal",(e=>{B.setButtonText(!0),p.editUserInfo(e).then((e=>{f.setUserInfo(e.name,e.job),B.close()})).catch((e=>{console.error(e)})).finally((()=>B.setButtonText(!1)))}));B.setEventListeners(),n.addEventListener("click",(()=>{g.open(),k["avatar-form"].resetValidation()})),a.addEventListener("click",(()=>{I.open(),k["card-form"].resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SCxvQkFFVixNQUFNd0csRUFBZSxJQUFJckcsRUQxR0QsdUJDNEdyQjhHLElBQ0NULEVBQWExRixlQUFjLEdBQzNCK0IsRUFDR2UsYUFBYXFELEdBQ2J0RCxNQUFNc0QsSUFDTHBDLEVBQVNPLFlBQVk2QixFQUFZak4sS0FBTWlOLEVBQVluRCxLQUNuRDBDLEVBQWEzRyxPQUFPLElBRXJCMkYsT0FBT0MsSUFDTm5KLFFBQVFvSixNQUFNRCxFQUFJLElBRW5Cb0IsU0FBUSxJQUFNTCxFQUFhMUYsZUFBYyxJQUFPLElBR3ZEMEYsRUFBYXhHLG9CQUVia0MsRUFBYXBHLGlCQUFpQixTQUFTLEtBQ3JDNkssRUFBWTVHLE9BQ1ppRyxFRHZJb0IsZUN1SXlCaEgsaUJBQWlCLElBR2hFb0QsRUFBV3RHLGlCQUFpQixTQUFTLEtBQ25Da0wsRUFBVWpILE9BQ1ZpRyxFRHBJa0IsYUNvSXlCaEgsaUJBQWlCLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3Ioe1xuICAgIG5hbWUsXG4gICAgbGluayxcbiAgICB1c2VySWQsXG4gICAgX2lkLFxuICAgIG93bmVySWQsXG4gICAgaXNMaWtlZCxcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGljayxcbiAgICBjYXJkU2VsZWN0b3IsXG4gIH0pIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XG4gICAgdGhpcy5fY2FyZElkID0gX2lkO1xuICAgIHRoaXMuX293bmVySWQgPSBvd25lcklkO1xuICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcblxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkLmNsb25lTm9kZSh0cnVlKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vIGxpa2UgYnV0dG9uXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KTtcbiAgICB9KTtcblxuICAgIC8vIGRlbGV0ZSBidXR0b25cbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdHJhc2hCdXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcykpO1xuICB9XG5cbiAgdG9nZ2xlTGlrZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoJ2NhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZScpO1xuICB9XG4gIFxuICByZW5kZXJMaWtlcygpIHtcbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgaXNsaWtlZCgpIHtcbiAgICBjb25zb2xlLmxvZyh0aGlzLl9saWtlcyk7XG4gIH1cblxuICBkZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLnJlbmRlckxpa2VzKCk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICAvLyB0aGlzLl9pc0xpa2VkKClcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgICAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICAgICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XG5cbiAgICAgICAgdGhpcy5faW5wdXRFbGVtcyA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSk7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICAgIH1cblxuICAgIF9kaXNhYmxlQnV0dG9uKCkge1xuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcbiAgICB9O1xuXG4gICAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH07XG5cbiAgICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtKSB7XG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW0gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW0uaWR9LWVycm9yYClcbiAgICAgICAgaW5wdXRFbGVtLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICAgICAgZXJyb3JNZXNzYWdlRWxlbS50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIGVycm9yTWVzc2FnZUVsZW0uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICB9XG5cbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbSkge1xuICAgICAgICBpZiAoIWlucHV0RWxlbS52YWxpZGl0eS52YWxpZCkge1xuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtLCBlcnJvck1lc3NhZ2UpIHtcbiAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbSA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbS5pZH0tZXJyb3JgKVxuICAgICAgICBpbnB1dEVsZW0uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvck1lc3NhZ2VFbGVtLnRleHRDb250ZW50ID0gaW5wdXRFbGVtLnZhbGlkYXRpb25NZXNzYWdlO1xuICAgICAgICBlcnJvck1lc3NhZ2VFbGVtLmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgfVxuXG4gICAgX2hhc0ludmFsaWRJbnB1dCgpIHtcbiAgICAgICAgcmV0dXJuICF0aGlzLl9pbnB1dEVsZW1zLmV2ZXJ5KChpbnB1dEVsZW0pID0+IHtcbiAgICAgICAgICAgIHJldHVybiBpbnB1dEVsZW0udmFsaWRpdHkudmFsaWQ7XG4gICAgICAgIH0pXG4gICAgfVxuXG4gICAgcmVzZXRWYWxpZGF0aW9uKCkge1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG5cbiAgICAgICAgdGhpcy5faW5wdXRFbGVtcy5mb3JFYWNoKChpbnB1dEVsZW0pID0+IHtcbiAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtKVxuICAgICAgfSk7XG4gICAgfTtcblxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcbiAgICAgICAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICAgIH07XG5cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX2lucHV0RWxlbXMuZm9yRWFjaCgoaW5wdXRFbGVtLCBpbmRleCwgYXJyYXkpID0+IHtcbiAgICAgICAgICAgIGlucHV0RWxlbS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIChldnQpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtKTtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxufVxuXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpIHx8XG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2NvbnRhaW5lci1wcmV2aWV3XCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Zvcm0taW5wdXRcIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgdGhpcy5faW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIHRoaXMuX2lucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXMuX2lucHV0VmFsdWVzO1xuICB9XG5cbiAgc2V0QnV0dG9uVGV4dChzdWJtaXQsIGJ1dHRvblRleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gICAgaWYgKHN1Ym1pdCkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gYnV0dG9uVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5fZGF0YSA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2RhdGEpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XG4gICAgc3VwZXIuY2xvc2UoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gICAgY29uc3RydWN0b3Ioe2l0ZW1zLCByZW5kZXJlcn0sIHNlbGVjdG9yKSB7XG4gICAgICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgICAgIHRoaXMuX3NlbGVjdG9yID0gc2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX3NlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3NlbGVjdG9yKVxuICAgIH07XG4gICAgXG4gICAgcmVuZGVySXRlbXMoKSB7XG4gICAgICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgYWRkSXRlbShpdGVtKSB7XG4gICAgICAgIHRoaXMuX3NlY3Rpb24ucHJlcGVuZChpdGVtKTtcbiAgICB9O1xufTtcbiIsImNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnIFwiLFxuICB9LFxuXTtcblxuY29uc3QgYXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2F2YXRhci1idXR0b24nKTtcbmNvbnN0IGF2YXRhckltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2ltYWdlJyk7XG5cbmNvbnN0IHByb2ZpbGVUaXRsZVRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5jb25zdCBwcm9maWxlRWRpdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5jb25zdCBjYXJkQWRkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuXG5jb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZS1mb3JtXCJdO1xuY29uc3QgY2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImNhcmQtZm9ybVwiXTtcblxuY29uc3QgZWRpdFByb2ZpbGVNb2RhbFRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNwcm9maWxlLXRpdGxlLWlucHV0XCJcbik7XG5jb25zdCBlZGl0UHJvZmlsZU1vZGFsRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcblxuY29uc3QgY2FyZFRpdGxlSW5wdXQgPSBjYXJkRm9ybS5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGl0bGUtaW5wdXRcIik7XG5jb25zdCBjYXJkSW1hZ2VJbnB1dCA9IGNhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1pbWFnZS1pbnB1dFwiKTtcbi8vIGh0dHBzOi8vaW1hZ2VzLnVuc3BsYXNoLmNvbS9waG90by0xNTUwMzMwNTQ1LTg3YzYxMDlhODFmNT9peGxpYj1yYi00LjAuMyZpeGlkPU1ud3hNakEzZkRCOE1IeHdhRzkwYnkxd1lXZGxmSHg4ZkdWdWZEQjhmSHg4JmF1dG89Zm9ybWF0JmZpdD1jcm9wJnc9MjY3MCZxPTgwXG5cbmNvbnN0IGNvbmZpZyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybS1pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yLXZpc2libGVcIixcbn07XG5cbmNvbnN0IGFwaUluZm8gPSB7XG4gIGFwaVRva2VuOiBcIjJhZWNmMTNiLWY4ODQtNDU1MC1hZmM4LTUzMzY0NzY3MjhiM1wiLFxuICBhcGlVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbn1cblxuY29uc3Qgc2VsZWN0b3JzID0ge1xuICBhdmF0YXJNb2RhbFNlbGVjdG9yOiBcIiNlZGl0LWF2YXRhci1tb2RhbFwiLFxuICBhdmF0YXJGb3JtU2VsZWN0b3I6IFwiYXZhdGFyLWZvcm1cIixcbiAgdXNlckF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19pbWFnZVwiLFxuICB1c2VyTmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICB1c2VySm9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG4gIGltYWdlTW9kYWxTZWxlY3RvcjogXCIjcHJldmlldy1jYXJkLW1vZGFsXCIsXG4gIGNhcmRMaXN0U2VsZWN0b3I6IFwiLmNhcmRzX19saXN0XCIsXG4gIGNhcmRTZWxlY3RvcjogXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICBjYXJkTW9kYWxTZWxlY3RvcjogXCIjYWRkLWNhcmQtbW9kYWxcIixcbiAgY2FyZEZvcm1TZWxlY3RvcjogXCJjYXJkLWZvcm1cIixcbiAgcHJvZmlsZU1vZGFsU2VsZWN0b3I6IFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiLFxuICBwcm9maWxlRm9ybVNlbGVjdG9yOiBcInByb2ZpbGUtZm9ybVwiLFxuICBjb25maXJtYXRpb25Nb2RhbFNlbGVjdG9yOiBcIiNkZWxldGUtbW9kYWxcIixcbn1cblxuZXhwb3J0IHtcbiAgYXZhdGFyQnV0dG9uLFxuICBhdmF0YXJJbWFnZSxcbiAgY29uZmlnLFxuICBjYXJkSW1hZ2VJbnB1dCxcbiAgY2FyZFRpdGxlSW5wdXQsXG4gIGVkaXRQcm9maWxlTW9kYWxEZXNjcmlwdGlvbklucHV0LFxuICBlZGl0UHJvZmlsZU1vZGFsVGl0bGVJbnB1dCxcbiAgY2FyZEZvcm0sXG4gIHByb2ZpbGVGb3JtLFxuICBjYXJkQWRkQnRuLFxuICBwcm9maWxlRWRpdEJ0bixcbiAgcHJvZmlsZURlc2NyaXB0aW9uVGV4dCxcbiAgcHJvZmlsZVRpdGxlVGV4dCxcbiAgc2VsZWN0b3JzLFxuICBhcGlJbmZvLFxufTtcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBQb3B1dVdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcbmltcG9ydCB7XG4gIGF2YXRhckJ1dHRvbixcbiAgYXZhdGFySW1hZ2UsXG4gIGNvbmZpZyxcbiAgZWRpdFByb2ZpbGVNb2RhbERlc2NyaXB0aW9uSW5wdXQsXG4gIGVkaXRQcm9maWxlTW9kYWxUaXRsZUlucHV0LFxuICBjYXJkQWRkQnRuLFxuICBwcm9maWxlRWRpdEJ0bixcbiAgc2VsZWN0b3JzLFxuICBhcGlJbmZvLFxufSBmcm9tIFwiLi4vdXRpbHMvdXRpbHMuanNcIjtcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xuY29uc3QgeyBhcGlUb2tlbiwgYXBpVXJsIH0gPSBhcGlJbmZvO1xubGV0IHVzZXJJZCA9IG51bGw7XG5sZXQgc2VjdGlvbiA9IG51bGw7XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBhcGlVcmwsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBhcGlUb2tlbixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcbiAgc2VsZWN0b3JzLnVzZXJOYW1lU2VsZWN0b3IsXG4gIHNlbGVjdG9ycy51c2VySm9iU2VsZWN0b3IsXG4gIHNlbGVjdG9ycy51c2VyQXZhdGFyU2VsZWN0b3IsXG4pO1xuXG5jb25zdCBoYW5kbGVEZWxldGVDbGljayA9IChjYXJkKSA9PiB7XG4gIGNvbmZpcm1hdGlvbk1vZGFsLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLl9pZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC5kZWxldGVDYXJkKCk7XG4gICAgICAgIGNvbmZpcm1hdGlvbk1vZGFsLmNsb3NlKClcbiAgICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KTtcbiAgfSlcbiAgY29uZmlybWF0aW9uTW9kYWwub3BlbigpXG59O1xuXG5jb25zdCBoYW5kbGVMaWtlQ2xpY2sgPSAoY2FyZCkgPT4ge1xuICBpZiAoY2FyZC5faXNMaWtlZCkge1xuICAgIGFwaVxuICAgICAgLnJlbW92ZUNhcmRMaWtlKGNhcmQuX2NhcmRJZClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgY2FyZC50b2dnbGVMaWtlQnV0dG9uKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSlcbiAgfSBlbHNlIHtcbiAgICBhcGlcbiAgICAgIC5hZGRDYXJkTGlrZShjYXJkLl9jYXJkSWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQudG9nZ2xlTGlrZUJ1dHRvbigpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICAgIH0pXG4gIH1cbn1cblxuY29uc3QgY29uZmlybWF0aW9uTW9kYWwgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKHNlbGVjdG9ycy5jb25maXJtYXRpb25Nb2RhbFNlbGVjdG9yKVxuY29uZmlybWF0aW9uTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuXG5Qcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXG4gIC50aGVuKChbZGF0YSwgY2FyZHNdKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xuICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgam9iOiBkYXRhLmFib3V0LFxuICAgICAgYXZhdGFyOiBkYXRhLmF2YXRhcixcbiAgICB9KTtcblxuICAgIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxuICAgICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICAgICAgc2VjdGlvbi5hZGRJdGVtKHJlbmRlckNhcmQoY2FyZERhdGEsIHVzZXJJZCkpO1xuICAgICAgICB9LFxuICAgICAgfSxcbiAgICAgIHNlbGVjdG9ycy5jYXJkTGlzdFNlbGVjdG9yXG4gICAgKTtcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9KTtcblxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcblxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmZvcm1TZWxlY3RvcikpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbSkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgZm9ybUVsZW0pO1xuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW0uZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcblxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICB9KTtcbn07XG5lbmFibGVWYWxpZGF0aW9uKGNvbmZpZyk7XG5cbnByb2ZpbGVFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IGluZm8gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuXG4gIGVkaXRQcm9maWxlTW9kYWxUaXRsZUlucHV0LnZhbHVlID0gaW5mby5uYW1lO1xuICBlZGl0UHJvZmlsZU1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IGluZm8uam9iO1xuXG4gIHByb2ZpbGVNb2RhbC5vcGVuKCk7XG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZS1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xufSk7XG5cbmNvbnN0IHJlbmRlckNhcmQgPSAoeyBuYW1lLCBsaW5rLCBfaWQsIG93bmVySWQsIGlzTGlrZWQgfSwgdXNlcklkKSA9PiB7XG4gIC8vIGNvbnNvbGUubG9nKHsgbmFtZSwgbGluaywgX2lkLCBvd25lcklkLCBsaWtlcyB9KTtcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKHtcbiAgICBuYW1lLFxuICAgIGxpbmssXG4gICAgdXNlcklkLFxuICAgIF9pZCxcbiAgICBvd25lcklkLFxuICAgIGlzTGlrZWQsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2ssXG4gICAgY2FyZFNlbGVjdG9yOiBzZWxlY3RvcnMuY2FyZFNlbGVjdG9yLFxuICB9KTtcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xufTtcblxuY29uc3QgaGFuZGxlSW1hZ2VDbGljayA9ICh7IG5hbWUsIGxpbmsgfSkgPT4ge1xuICBpbWFnZU1vZGFsLm9wZW4oeyBuYW1lLCBsaW5rIH0pO1xufTtcblxuY29uc3QgYXZhdGFyTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShzZWxlY3RvcnMuYXZhdGFyTW9kYWxTZWxlY3RvciwgKGF2YXRhckRhdGEpID0+IHtcbiAgYXZhdGFyTW9kYWwuc2V0QnV0dG9uVGV4dCh0cnVlKTtcbiAgYXBpXG4gICAgLmVkaXRQcm9maWxlUGhvdG8oYXZhdGFyRGF0YSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgY29uc29sZS5sb2coZGF0YSlcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpXG4gICAgICBhdmF0YXJNb2RhbC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IGF2YXRhck1vZGFsLnNldEJ1dHRvblRleHQoKSk7XG59KTtcbmF2YXRhck1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGltYWdlTW9kYWwgPSBuZXcgUG9wdXVXaXRoSW1hZ2Uoc2VsZWN0b3JzLmltYWdlTW9kYWxTZWxlY3Rvcik7XG5pbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGNhcmRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHNlbGVjdG9ycy5jYXJkTW9kYWxTZWxlY3RvciwgKGNhcmREYXRhKSA9PiB7XG4gIGNhcmRNb2RhbC5zZXRCdXR0b25UZXh0KHRydWUpO1xuICBhcGlcbiAgICAuY3JlYXRlQ2FyZChjYXJkRGF0YSlcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgc2VjdGlvbi5hZGRJdGVtKHJlbmRlckNhcmQoZGF0YSwgdXNlcklkKSk7XG4gICAgICBjYXJkTW9kYWwuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiBjYXJkTW9kYWwuc2V0QnV0dG9uVGV4dChmYWxzZSkpXG59KTtcbmNhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwcm9maWxlTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgc2VsZWN0b3JzLnByb2ZpbGVNb2RhbFNlbGVjdG9yLFxuICAocHJvZmlsZURhdGEpID0+IHtcbiAgICBwcm9maWxlTW9kYWwuc2V0QnV0dG9uVGV4dCh0cnVlKTtcbiAgICBhcGlcbiAgICAgIC5lZGl0VXNlckluZm8ocHJvZmlsZURhdGEpXG4gICAgICAudGhlbigocHJvZmlsZURhdGEpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocHJvZmlsZURhdGEubmFtZSwgcHJvZmlsZURhdGEuam9iKTtcbiAgICAgICAgcHJvZmlsZU1vZGFsLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHByb2ZpbGVNb2RhbC5zZXRCdXR0b25UZXh0KGZhbHNlKSlcbiAgfVxuKTtcbnByb2ZpbGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5hdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gIGF2YXRhck1vZGFsLm9wZW4oKVxuICBmb3JtVmFsaWRhdG9yc1tzZWxlY3RvcnMuYXZhdGFyRm9ybVNlbGVjdG9yXS5yZXNldFZhbGlkYXRpb24oKVxufSlcblxuY2FyZEFkZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjYXJkTW9kYWwub3BlbigpO1xuICBmb3JtVmFsaWRhdG9yc1tzZWxlY3RvcnMuY2FyZEZvcm1TZWxlY3Rvcl0ucmVzZXRWYWxpZGF0aW9uKCk7XG59KTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICBfaGFuZGxlUmVzcG9uY2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH1cbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25jZSk7XG4gIH1cblxuICBlZGl0VXNlckluZm8oe25hbWUsIGpvYn0pIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGFib3V0OiBqb2IsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbmNlKTtcbiAgfVxuXG4gIGVkaXRQcm9maWxlUGhvdG8oZGF0YSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogZGF0YS5hdmF0YXIsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbmNlKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uY2UpO1xuICB9XG5cbiAgY3JlYXRlQ2FyZChkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgbGluazogZGF0YS5saW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25jZSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uY2UpO1xuICB9XG5cbiAgYWRkQ2FyZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVSZXNwb25jZSk7XG4gIH1cblxuICByZW1vdmVDYXJkTGlrZShjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVJlc3BvbmNlKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3RvcihuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX25hbWVFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xuICAgIHRoaXMuX2pvYkVsZW0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcbiAgICB0aGlzLl9hdmF0YXJFbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW0udGV4dENvbnRlbnQsXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW0udGV4dENvbnRlbnQsXG4gICAgICBhdmF0YXI6IHRoaXMuX2F2YXRhckVsZW0uc3JjLFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyh7bmFtZSwgam9iLCBhdmF0YXJ9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW0udGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2pvYkVsZW0udGV4dENvbnRlbnQgPSBqb2I7XG4gICAgaWYgKGF2YXRhcikge1xuICAgICAgdGhpcy5fYXZhdGFyRWxlbS5zcmMgPSBhdmF0YXI7XG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3RvcilcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgfVxuXG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICAgICAgICBzdXBlci5vcGVuKClcbiAgICB9XG5cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5fZm9ybS5yZXNldCgpO1xuICAgICAgICBzdXBlci5jbG9zZSgpXG4gICAgfVxuXG4gICAgc2V0U3VibWl0QWN0aW9uKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBjYWxsYmFjaztcbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KClcbiAgICAgICAgfSlcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKVxuICAgIH1cbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl90aXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG4gICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbiAgfTtcblxuICBvcGVuKHsgbGluaywgbmFtZSB9KSB7XG4gICAgdGhpcy5fdGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XG4gICAgdGhpcy5faW1hZ2UuYWx0ID0gbmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH07XG59O1xuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJuYW1lIiwibGluayIsInVzZXJJZCIsIl9pZCIsIm93bmVySWQiLCJpc0xpa2VkIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwiY2FyZFNlbGVjdG9yIiwidGhpcyIsIl9uYW1lIiwiX2xpbmsiLCJfdXNlcklkIiwiX2NhcmRJZCIsIl9vd25lcklkIiwiX2lzTGlrZWQiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfY2FyZFNlbGVjdG9yIiwiX2NhcmRFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwiX2NhcmRJbWFnZSIsIl9saWtlQnV0dG9uIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsInRvZ2dsZUxpa2VCdXR0b24iLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJyZW5kZXJMaWtlcyIsImFkZCIsInJlbW92ZSIsImlzbGlrZWQiLCJjb25zb2xlIiwibG9nIiwiX2xpa2VzIiwiZGVsZXRlQ2FyZCIsImdldFZpZXciLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0RWxlbXMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsIl9kaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJfZW5hYmxlQnV0dG9uIiwiX2hpZGVJbnB1dEVycm9yIiwiaW5wdXRFbGVtIiwiZXJyb3JNZXNzYWdlRWxlbSIsImlkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oYXNJbnZhbGlkSW5wdXQiLCJldmVyeSIsInJlc2V0VmFsaWRhdGlvbiIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZm9yRWFjaCIsImluZGV4IiwiYXJyYXkiLCJldnQiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJrZXkiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJvcGVuIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9mb3JtIiwiX2lucHV0TGlzdCIsIl9zdWJtaXRCdXR0b25UZXh0IiwiX2dldElucHV0VmFsdWVzIiwiX2lucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInNldEJ1dHRvblRleHQiLCJzdWJtaXQiLCJidXR0b25UZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiX2RhdGEiLCJyZXNldCIsIlNlY3Rpb24iLCJzZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfc2VsZWN0b3IiLCJfc2VjdGlvbiIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJwcmVwZW5kIiwiYXZhdGFyQnV0dG9uIiwicHJvZmlsZUVkaXRCdG4iLCJjYXJkQWRkQnRuIiwiY2FyZEZvcm0iLCJmb3JtcyIsImVkaXRQcm9maWxlTW9kYWxUaXRsZUlucHV0IiwiZWRpdFByb2ZpbGVNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJzZWxlY3RvcnMiLCJhcGlUb2tlbiIsImFwaVVybCIsInNlY3Rpb24iLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfaGFuZGxlUmVzcG9uY2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJlZGl0VXNlckluZm8iLCJfcmVmMiIsImpvYiIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJlZGl0UHJvZmlsZVBob3RvIiwiZGF0YSIsImF2YXRhciIsImdldEluaXRpYWxDYXJkcyIsImNyZWF0ZUNhcmQiLCJjYXJkSWQiLCJhZGRDYXJkTGlrZSIsInJlbW92ZUNhcmRMaWtlIiwiYXV0aG9yaXphdGlvbiIsInVzZXJJbmZvIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbSIsIl9qb2JFbGVtIiwiX2F2YXRhckVsZW0iLCJzZXRVc2VySW5mbyIsImNhcmQiLCJjb25maXJtYXRpb25Nb2RhbCIsInNldFN1Ym1pdEFjdGlvbiIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJjYWxsYmFjayIsImFsbCIsImNhcmRzIiwiY2FyZERhdGEiLCJyZW5kZXJDYXJkIiwiZm9ybVZhbGlkYXRvcnMiLCJjb25maWciLCJmb3JtU2VsZWN0b3IiLCJmb3JtRWxlbSIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIiwiaW5mbyIsInByb2ZpbGVNb2RhbCIsIl9yZWYzIiwiaW1hZ2VNb2RhbCIsImF2YXRhck1vZGFsIiwiYXZhdGFyRGF0YSIsImZpbmFsbHkiLCJfdGl0bGUiLCJfaW1hZ2UiLCJjYXJkTW9kYWwiLCJwcm9maWxlRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=